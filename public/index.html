<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Generator with Database</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        input, button, select {
            margin: 10px 0;
            padding: 5px;
        }
        #passwordList {
            white-space: pre-wrap;
            background-color: #f0f0f0;
            padding: 10px;
            border-radius: 5px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>Password Generator with Database</h1>
    <div>
        <label for="length">Password Length:</label>
        <input type="number" id="length" min="1" max="8" value="3">
    </div>
    <div>
        <label for="useUppercase">Use Uppercase:</label>
        <input type="checkbox" id="useUppercase" checked>
    </div>
    <div>
        <label for="useLowercase">Use Lowercase:</label>
        <input type="checkbox" id="useLowercase" checked>
    </div>
    <div>
        <label for="useNumbers">Use Numbers:</label>
        <input type="checkbox" id="useNumbers" checked>
    </div>
    <div>
        <label for="useSpecial">Use Special Characters:</label>
        <input type="checkbox" id="useSpecial">
    </div>
    <button onclick="generatePasswords()">Generate Passwords</button>
    <button onclick="downloadPasswords()">Download Password List</button>
    <h2>Sample of Generated Passwords:</h2>
    <div id="passwordList"></div>
    <div id="stats"></div>

    <script>
        let passwords = [];

        async function generatePasswords() {
            const length = parseInt(document.getElementById('length').value);
            const useUppercase = document.getElementById('useUppercase').checked;
            const useLowercase = document.getElementById('useLowercase').checked;
            const useNumbers = document.getElementById('useNumbers').checked;
            const useSpecial = document.getElementById('useSpecial').checked;

            const response = await fetch('/generate', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ length, useUppercase, useLowercase, useNumbers, useSpecial }),
            });

            const data = await response.json();
            passwords = data.passwords;

            // Display a sample of passwords and stats
            const sampleSize = Math.min(100, passwords.length);
            const sample = passwords.slice(0, sampleSize);
            document.getElementById('passwordList').textContent = sample.join('\n');
            document.getElementById('stats').textContent = `Total passwords generated: ${passwords.length}`;
        }

        function downloadPasswords() {
            if (passwords.length === 0) {
                alert('Please generate passwords first!');
                return;
            }
            const blob = new Blob([passwords.join('\n')], {type: "text/plain;charset=utf-8"});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'password_list.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }
    </script>
</body>
</html>
